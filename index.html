<!DOCTYPE html>
<html lang="pt-BR" prefix="og: https://ogp.me/ns#">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Ozoxx | Acesso Exclusivo a Produtos Premium</title>
    
    <meta name="description" content="Acesso exclusivo Ozoxx. Produtos premium para sa√∫de e qualidade de vida.">
    <meta name="keywords" content="ozoxx, produtos, sa√∫de, bem-estar, terapia">
    <meta name="author" content="Ozoxx">
    <meta name="robots" content="index, follow">
    
    <!-- PRELOAD E PRE-CONNECT PARA PERFORMANCE -->
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://script.google.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    
    <!-- GOOGLE TAG MANAGER (HEAD) - VERS√ÉO OTIMIZADA -->
    <script>
    (function(w,d,s,l,i){
        w[l]=w[l]||[];
        w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        
        // Carregamento otimizado sem bloquear
        setTimeout(function(){
            var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        },1500);
    })(window,document,'script','dataLayer','GTM-NTT7KD6G');
    </script>
    <!-- END GOOGLE TAG MANAGER -->
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}.gate-container{background:#fff;border-radius:10px;padding:clamp(20px,5vw,40px);box-shadow:0 10px 40px rgba(0,0,0,.2);max-width:min(500px,90vw);width:100%}h1{color:#333;font-size:clamp(1.5rem,4vw,2rem);margin-bottom:10px;text-align:center}.subtitle{color:#666;text-align:center;margin-bottom:30px;font-size:clamp(.9rem,2.5vw,1.1rem)}.form-group{margin-bottom:20px}input{width:100%;padding:14px;border:2px solid #e1e1e1;border-radius:6px;font-size:16px;min-height:52px}input:focus{border-color:#667eea;outline:0}button{width:100%;padding:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2);color:#fff;border:0;border-radius:6px;font-size:1rem;cursor:pointer;min-height:52px;font-weight:600}.privacy{font-size:.75rem;color:#888;text-align:center;margin-top:25px}#errorMsg{display:none;color:#d00;padding:12px;margin-top:15px;border:1px solid #fcc;background:#fee;border-radius:6px}#loading{display:none;text-align:center;margin:20px 0;color:#667eea}
    </style>
    
    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"WebPage","name":"Ozoxx Acesso Exclusivo","description":"P√°gina de acesso exclusivo Ozoxx","publisher":{"@type":"Organization","name":"Ozoxx"}}
    </script>
</head>
<body>
    <!-- GOOGLE TAG MANAGER (NOSCRIPT) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NTT7KD6G"
                height="0" width="0"
                style="display:none;visibility:hidden"
                title="Google Tag Manager">
        </iframe>
    </noscript>
    <!-- END GOOGLE TAG MANAGER (NOSCRIPT) -->
    
    <div class="gate-container">
        <h1>üéÅ Conhe√ßa o Ozoxx</h1>
        <p class="subtitle">Preencha para acessar conte√∫do exclusivo</p>
        
        <form id="leadForm">
            <!-- Nome -->
            <div class="form-group">
                <input type="text" 
                       name="nome" 
                       placeholder="Seu nome completo" 
                       required 
                       aria-label="Nome"
                       autocomplete="name"
                       minlength="2">
            </div>
            
            <!-- Telefone BR - REGEX CORRIGIDA -->
            <div class="form-group">
                <input type="tel" 
                       name="tel" 
                       id="phoneInput"
                       placeholder="(11) 99999-9999" 
                       required 
                       aria-label="Telefone"
                       autocomplete="tel"
                       pattern="^\([1-9]{2}\) 9[0-9]{4}-[0-9]{4}$"
                       title="(DDD) 99999-9999"
                       maxlength="15">
            </div>
            
            <!-- Email - REGEX CORRIGIDA -->
            <div class="form-group">
                <input type="email" 
                       name="email" 
                       placeholder="seu@email.com" 
                       required
                       aria-label="Email"
                       autocomplete="email"
                       pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                       title="ex: nome@gmail.com"
                       maxlength="100">
            </div>
            
            <button type="submit" id="submitBtn">
                üëâ Acessar Conte√∫do Exclusivo
            </button>
            
            <div id="loading">Processando...</div>
            <div id="errorMsg"></div>
        </form>
        
        <p class="privacy">
            üîí Seus dados est√£o protegidos.
        </p>
    </div>

    <!-- JAVASCRIPT CORRIGIDO COM INTEGRA√á√ÉO GTM -->
    <script>
    !function(){'use strict';
    // ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è ALTERE ESTA URL PARA A DO SEU GOOGLE APPS SCRIPT ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
    const API_URL='https://script.google.com/macros/s/AKfycbyVxcQuPmxshpZmigu-LDTTLF3dZGGdWFdLYbxdqgusW1XDDbl8jHN5GNzlVaMsfj8J/exec';
    const REDIRECT_URL='https://ozoxxvenda.github.io/ozoxxterapia/home.html';
    
    // Inicializa dataLayer para GTM
    window.dataLayer = window.dataLayer || [];
    
    function init(){
        const f=document.getElementById('leadForm'),p=document.getElementById('phoneInput');
        if(!f)return;
        
        // Formata√ß√£o telefone
        p&&p.addEventListener('input',function(e){
            let v=e.target.value.replace(/\D/g,'');
            v.length>11&&(v=v.substring(0,11));
            if(v.length>0){
                v='('+v;
                v.length>3&&(v=v.substring(0,3)+') '+v.substring(3));
                v.length>10&&(v=v.substring(0,10)+'-'+v.substring(10));
            }
            e.target.value=v;
        });
        
        // Envio formul√°rio
        f.addEventListener('submit',async function(e){
            e.preventDefault();
            const b=this.querySelector('button[type="submit"]');
            if(!b)return;
            
            // Validar antes de enviar
            if(!this.checkValidity()){
                this.reportValidity();
                return;
            }
            
            // Disparar evento GTM de in√≠cio do formul√°rio
            try {
                window.dataLayer.push({
                    'event': 'form_submission_start',
                    'form_type': 'ozoxx_capture'
                });
            } catch(e) { console.log('GTM push error:', e); }
            
            b.disabled=true;
            b.textContent='Enviando...';
            const l=document.getElementById('loading');
            l&&(l.style.display='block');
            
            try{
                const d={
                    nome:this.nome.value.trim(),
                    email:this.email.value.trim(),
                    tel:this.tel.value.trim()
                };
                
                console.log('Enviando:',d);
                
                const r=await fetch(API_URL,{
                    method:'POST',
                    headers:{'Content-Type':'application/x-www-form-urlencoded'},
                    body:new URLSearchParams(d).toString()
                });
                
                const j=await r.json();
                console.log('Resposta:',j);
                
                if(j.success){
                    // Disparar evento GTM de sucesso
                    try {
                        window.dataLayer.push({
                            'event': 'form_submission_success',
                            'form_type': 'ozoxx_capture',
                            'lead_data': {
                                'has_name': !!d.nome,
                                'has_email': !!d.email,
                                'has_phone': !!d.tel
                            }
                        });
                    } catch(e) { console.log('GTM success error:', e); }
                    
                    localStorage.setItem('ozoxx_done','true');
                    setTimeout(()=>{
                        window.location.href=REDIRECT_URL;
                    },800);
                }else{
                    throw new Error(j.message||'Erro');
                }
                
            }catch(err){
                console.error('Erro:',err);
                
                // Disparar evento GTM de erro
                try {
                    window.dataLayer.push({
                        'event': 'form_submission_error',
                        'form_type': 'ozoxx_capture',
                        'error_message': err.message.substring(0, 100)
                    });
                } catch(e) { console.log('GTM error push error:', e); }
                
                b.disabled=false;
                b.textContent='üëâ Acessar Conte√∫do Exclusivo';
                l&&(l.style.display='none');
                showError(err.name==='TypeError'?'Erro de conex√£o':'Erro: '+err.message);
            }
        });
        
        // Disparar evento de visualiza√ß√£o da p√°gina
        try {
            window.dataLayer.push({
                'event': 'page_view',
                'page_type': 'ozoxx_capture_page'
            });
        } catch(e) { console.log('GTM pageview error:', e); }
    }
    
    function showError(m){
        let e=document.getElementById('errorMsg');
        e||(e=document.createElement('div'),e.id='errorMsg',e.style.cssText='color:#d00;padding:12px;margin-top:15px;border:1px solid #fcc;background:#fee;border-radius:6px;',document.querySelector('.gate-container').appendChild(e));
        e.textContent='‚ùå '+m;
        e.style.display='block';
        setTimeout(()=>e.style.display='none',5000);
    }
    
    document.readyState!=='loading'?init():document.addEventListener('DOMContentLoaded',init);
    }();
    </script>
</body>
</html>
