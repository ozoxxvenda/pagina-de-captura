class LeadCapture{constructor(){this.m={s:Date.now(),f:0};this.init()}init(){document.addEventListener("focusin",e=>{e.target.tagName==="INPUT"&&this.m.f++},{passive:!0});const e=document.getElementById("leadForm");e&&e.addEventListener("submit",t=>this.hs(t));const t=document.createElement("input");t.type="text",t.name="h",t.style.cssText="opacity:0;position:absolute;left:-9999px;",t.tabIndex=-1,e.appendChild(t)}async hs(e){e.preventDefault();const t=e.target,n=new FormData(t);if(n.get("h"))return;const o=n.get("nome")?.trim(),c=n.get("tel")?.trim(),a=n.get("email")?.trim();if(!o||!c)return void this.err("Nome e telefone obrigatÃ³rios");const s=document.getElementById("submitBtn"),r=s.textContent;s.disabled=!0,s.textContent="Processando...";try{const i=await fetch("https://script.google.com/macros/s/AKfycbzLzYlNzHG2z1snKMpi70xuGCVv9xN7WtKxMcK_ChKexeK_phXdmlHajD14Vcb2FIzz/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({n:o,t:c,e:a||"",ts:new Date().toISOString()})});console.log("Resposta do servidor:",await i.text());localStorage.setItem("fc","1");location.href="home.html"}catch(s){console.error("Erro no fetch:",s),this.err("Erro. Tente novamente.")}finally{s.disabled=!1,s.textContent=r}}err(e){const t=document.createElement("div");t.textContent=e,t.style.cssText="background:#f56565;color:#fff;padding:10px;margin:10px 0;border-radius:4px;font-size:14px;",t.setAttribute("role","alert");const n=document.getElementById("leadForm");n.prepend(t),setTimeout(()=>t.remove(),4e3)}}document.addEventListener("DOMContentLoaded",()=>new LeadCapture);
